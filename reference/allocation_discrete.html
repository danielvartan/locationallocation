<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute the maximal coverage location-allocation for discrete problems — allocation_discrete • locationallocation</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute the maximal coverage location-allocation for discrete problems — allocation_discrete"><meta name="description" content="allocation_discrete() allocates facilities in a discrete location problem.
It uses the accumulated cost algorithm to identify optimal facility locations
based on the share of demand to be covered, given a user-defined set
of candidate locations and a maximum number of allocable facilities.
If a objectiveshare parameter is specified, the algorithm identifies the
best set of size of up to n_fac facilities to achieve the targeted coverage
share. The problem is solved using a statistical heuristic approach that
generates samples of the candidate locations (on top of the existing
locations) and selects the facilities in the one that minimizes the objective
function.
See allocation() for continuous location-allocation
problems."><meta property="og:description" content="allocation_discrete() allocates facilities in a discrete location problem.
It uses the accumulated cost algorithm to identify optimal facility locations
based on the share of demand to be covered, given a user-defined set
of candidate locations and a maximum number of allocable facilities.
If a objectiveshare parameter is specified, the algorithm identifies the
best set of size of up to n_fac facilities to achieve the targeted coverage
share. The problem is solved using a statistical heuristic approach that
generates samples of the candidate locations (on top of the existing
locations) and selects the facilities in the one that minimizes the objective
function.
See allocation() for continuous location-allocation
problems."><meta property="og:image" content="https://giacfalk.github.io/locationallocation/reference/figures/og-image.png"><meta property="og:image:alt" content="locationallocation"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">locationallocation</a>

    <small class="nav-text text-warning me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/giacfalk/locationallocation/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Compute the maximal coverage location-allocation for discrete problems</h1>
      <small class="dont-index">Source: <a href="https://github.com/giacfalk/locationallocation/blob/main/R/allocation_discrete.R" class="external-link"><code>R/allocation_discrete.R</code></a></small>
      <div class="d-none name"><code>allocation_discrete.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>allocation_discrete()</code> allocates facilities in a discrete location problem.
It uses the accumulated cost algorithm to identify optimal facility locations
based on the share of demand to be covered, given a user-defined set
of candidate locations and a maximum number of allocable facilities.</p>
<p>If a <code>objectiveshare</code> parameter is specified, the algorithm identifies the
best set of size of up to <code>n_fac</code> facilities to achieve the targeted coverage
share. The problem is solved using a statistical heuristic approach that
generates samples of the candidate locations (on top of the existing
locations) and selects the facilities in the one that minimizes the objective
function.</p>
<p>See <code><a href="allocation.html">allocation()</a></code> for continuous location-allocation
problems.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">allocation_discrete</span><span class="op">(</span></span>
<span>  <span class="va">demand</span>,</span>
<span>  <span class="va">bb_area</span>,</span>
<span>  <span class="va">candidate</span>,</span>
<span>  facilities <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_fac <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  traveltime <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"walk"</span>,</span>
<span>  dowscaling_model_type <span class="op">=</span> <span class="st">"lm"</span>,</span>
<span>  res_output <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  objectiveminutes <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  objectiveshare <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  approach <span class="op">=</span> <span class="st">"norm"</span>,</span>
<span>  exp_demand <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  exp_weights <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  par <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-demand">demand<a class="anchor" aria-label="anchor" href="#arg-demand"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">RasterLayer</a></code> object with the
demand layer (e.g. population density).</p></dd>


<dt id="arg-bb-area">bb_area<a class="anchor" aria-label="anchor" href="#arg-bb-area"></a></dt>
<dd><p>A <code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">sf</a></code> boundary box object with the area
of interest.</p></dd>


<dt id="arg-candidate">candidate<a class="anchor" aria-label="anchor" href="#arg-candidate"></a></dt>
<dd><p>A <code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">sf</a></code> object with the candidate
locations for the new facilities.</p></dd>


<dt id="arg-facilities">facilities<a class="anchor" aria-label="anchor" href="#arg-facilities"></a></dt>
<dd><p>A <code><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">sf</a></code> object with the existing
facilities.</p></dd>


<dt id="arg-n-fac">n_fac<a class="anchor" aria-label="anchor" href="#arg-n-fac"></a></dt>
<dd><p>(optional) A positive <a href="https://mllg.github.io/checkmate/reference/checkIntegerish.html" class="external-link">integerish</a>
number indicating the maximum number of facilities that can be allocated
(default: <code>Inf</code>).</p></dd>


<dt id="arg-n-samples">n_samples<a class="anchor" aria-label="anchor" href="#arg-n-samples"></a></dt>
<dd><p>(optional) A positive
<a href="https://mllg.github.io/checkmate/reference/checkIntegerish.html" class="external-link">integerish</a> number indicating the number of
samples to generate in the heuristic approach for identifying the best set
of facilities to be allocated (default: <code>1000</code>).</p></dd>


<dt id="arg-traveltime">traveltime<a class="anchor" aria-label="anchor" href="#arg-traveltime"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> with the output of the
<code><a href="traveltime.html">traveltime()</a></code> function. If not provided, the function will
run the <code><a href="traveltime.html">traveltime()</a></code> function based on the provided
parameters.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>(optional) A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code> string indicating
the mode of transport. Options are <code>"fastest"</code> and <code>"walk"</code> (default =
<code>"walk"</code>).</p><ul><li><p>For <code>"fastest"</code>: The friction layer accounts for multiple modes of
transport, including walking, cycling, driving, and public transport, and are
based on the Malaria Atlas Project (2019) <em>Global Travel Speed Friction
Surface</em>.</p></li>
<li><p>For <code>"walk"</code>: The friction layer accounts only for walking speeds and is
based on the Malaria Atlas Project (2015) <em>Global Walking Only Friction
Surface</em>.</p></li>
</ul></dd>


<dt id="arg-dowscaling-model-type">dowscaling_model_type<a class="anchor" aria-label="anchor" href="#arg-dowscaling-model-type"></a></dt>
<dd><p>(optional) A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></code>
string indicating the type of model used for the spatial downscaling of the
friction layer. Options are <code>"lm"</code> (linear model) and <code>"rf"</code> (random
forest) (default: <code>"lm"</code>).</p></dd>


<dt id="arg-res-output">res_output<a class="anchor" aria-label="anchor" href="#arg-res-output"></a></dt>
<dd><p>(optional) A positive
<a href="https://mllg.github.io/checkmate/reference/checkIntegerish.html" class="external-link">integerish</a> number indicating the spatial
resolution of the friction raster (and of the analysis), in meters. If the
resolution is less than <code>1000</code>, a spatial downscaling approach is used
(default: <code>100</code>).</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>(optional) A raster with the weights for the demand (default:
<code>NULL</code>).</p></dd>


<dt id="arg-objectiveminutes">objectiveminutes<a class="anchor" aria-label="anchor" href="#arg-objectiveminutes"></a></dt>
<dd><p>(optional) A number indicating the target travel time
in minutes used to compute the statistics (default: <code>15</code>).</p></dd>


<dt id="arg-objectiveshare">objectiveshare<a class="anchor" aria-label="anchor" href="#arg-objectiveshare"></a></dt>
<dd><p>(optional) A number indicating the proportion of the
demand to be covered by adding at most the number of facilities defined by
the <code>n_fac</code> parameter from the pool of candidate facilities
(default: <code>NULL</code>).</p></dd>


<dt id="arg-approach">approach<a class="anchor" aria-label="anchor" href="#arg-approach"></a></dt>
<dd><p>(optional) The approach to be used for the allocation.
Options are <code>"norm"</code> and <code>"absweights"</code>. If "norm", the allocation is based
on the normalized demand raster multiplied by the normalized weights
raster. If <code>"absweights"</code>, the allocation is based on the normalized demand
raster multiplied by the raw weights raster (default: <code>"norm"</code>).</p></dd>


<dt id="arg-exp-demand">exp_demand<a class="anchor" aria-label="anchor" href="#arg-exp-demand"></a></dt>
<dd><p>(optional) The exponent for the demand raster. Default is</p><ol><li><p>A higher value will give less relative weight to areas with higher
demand - with respect to the weights layer. This is useful in cases where
the users want to increase the allocation in areas with higher values in
the weights layer (default: <code>1</code>).</p></li>
</ol></dd>


<dt id="arg-exp-weights">exp_weights<a class="anchor" aria-label="anchor" href="#arg-exp-weights"></a></dt>
<dd><p>(optional) The exponent for the weights raster. Default is</p><ol><li><p>A higher value will give less relative weight to areas with higher
weights - with respect to the demand layer. This is useful in cases where
the users want to increase the allocation in areas with higher values in
the demand layer (default: <code>1</code>).</p></li>
</ol></dd>


<dt id="arg-par">par<a class="anchor" aria-label="anchor" href="#arg-par"></a></dt>
<dd><p>(optional) A <code><a href="https://rdrr.io/r/base/logical.html" class="external-link">logical</a></code> flag indicating whether
to run the function in <a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parallel</a> or not
(default: <code>FALSE</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a> <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></code> with the
following elements:</p><ul><li><p><code>coverage</code>: A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> value indicating the share of
demand covered within the objective travel time after allocating the new
facilities.</p></li>
<li><p><code>unmet_demand</code>: A <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></code> value indicating the share
of demand that remains unmet after allocating the new facilities.</p></li>
<li><p><code>objective_minutes</code>: The value of the <code>objectiveminutes</code> parameter used.</p></li>
<li><p><code>objective_share</code>: The value of the <code>objectiveshare</code> parameter used.</p></li>
<li><p><code>facilities</code>: A <code><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">sf</a></code> object with the newly allocated
facilities.</p></li>
<li><p><code>travel_time</code>: A <code><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></code> RasterLayer object
representing the travel time map with the newly allocated facilities.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other location-allocation functions:
<code><a href="allocation.html">allocation()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">allocation_data</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="va">naples_population</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu">allocation_discrete</span><span class="op">(</span></span></span>
<span class="r-in"><span>      traveltime <span class="op">=</span> <span class="va">traveltime</span>,</span></span>
<span class="r-in"><span>      bb_area <span class="op">=</span> <span class="va">naples_shape</span>,</span></span>
<span class="r-in"><span>      facilities <span class="op">=</span> <span class="va">naples_fountains</span>,</span></span>
<span class="r-in"><span>      candidate <span class="op">=</span> <span class="va">naples_shape</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_sample.html" class="external-link">st_sample</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      n_fac <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>      weights <span class="op">=</span> <span class="va">naples_hot_days</span>,</span></span>
<span class="r-in"><span>      objectiveminutes <span class="op">=</span> <span class="fl">15</span>,</span></span>
<span class="r-in"><span>      objectiveshare <span class="op">=</span> <span class="fl">0.9</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">allocation_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">allocation_data</span> <span class="op">|&gt;</span> <span class="fu"><a href="allocation_plot.html">allocation_plot</a></span><span class="op">(</span><span class="va">naples_shape</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/giacfalk/" class="external-link">Giacomo Falchetta</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

